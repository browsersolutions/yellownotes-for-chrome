document.getElementById('captureBtn').addEventListener('click', function() {
    chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
        chrome.scripting.executeScript({
            target: {tabId: tabs[0].id},
            func: captureThumbnail
        }, (injectionResults) => {
            for (const frameResult of injectionResults)
                document.getElementById('thumbnail').src = frameResult.result;
        });
    });
});

function captureThumbnail() {
    return new Promise((resolve, reject) => {
        try {
            html2canvas(document.body).then(canvas => {
                resolve(canvas.toDataURL());
            });
        } catch (error) {
            reject(error.toString());
        }
    });
}
